<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title></title>
  <!-- bootstrap 5 cdn -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  <!-- fontawesome cdn-->
  <script src="https://kit.fontawesome.com/fbd42d8532.js" crossorigin="anonymous"></script>
  <!-- custom css -->
  <link rel="stylesheet" href="css/pim.css">
</head>

<body>
  <div id="divid">
    
    <h3 id="id"></h3>
    <button id="logout">Log out</button>
  </div>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark nav-2 pim-nav">
    <div class="container-fluid">
      <a class="navbar-brand" href="#"> Personal Info Manager </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav>

  <div class="pim-tab-navigation">
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">Basic Details</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false">Personal Details</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab" aria-controls="contact" aria-selected="false">Address</button>
      </li>
    </ul>
    <div class="tab-content" id="myTabContent">
      <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
        <!-- basic details content -->
        <div class="pim-form-basic">
          <form class="row g-3 align-center">
            <!-- Email -->
            <div class="col-md-6">
              <label for="inputEmail4" class="form-label ">Email</label>
              <input type="email" class="form-control h-60" id="inputEmail4">
            </div>
            <!-- Password -->
            <div class="col-md-6 basic-input">
              <label for="username4" class="form-label">Username</label>
              <input type="text" class="form-control" id="username4">
            </div>
            <!-- preffered languages -->
            <div class="input-group mb-3 basic-input ">
              <label class="input-group-text h-100" for="inputGroupSelect01">Preffered Language</label>
              <select class="form-select" id="inputGroupSelect01">
                <option selected>Choose a Language</option>
                <option value="english">English</option>
                <option value="hindi">Hindi</option>
                <option value="marathi">Marathi</option>
                <option value="bengali">Bengali</option>
                <option value="maithili">Maithili</option>
                <option value="nepalese">Nepalese</option>
                <option value="sanskrit">Sanskrit</option>
                <option value="tamil">Tamil</option>
                <option value="urdu">Urdu</option>
                <option value="assamese">Assamese</option>
                <option value="dogri">Dogri</option>
                <option value="kannada">Kannada</option>
                <option value="gujarati">Gujarati</option>
                <option value="bodo">Bodo</option>
                <option value="manipur">Manipur</option>
                <option value="oriya">Oriya</option>
                <option value="santali">Santali</option>
                <option value="telugu">Telugu</option>
                <option value="punjabi">Punjabi</option>
                <option value="sindhi">Sindhi</option>
                <option value="malayalam">Malayalam</option>
                <option value="konkani">Konkani</option>
                <option value="kashmiri">Kashmiri</option>
              </select>
            </div>
            <!-- security questions -->
            <div class="input-group mb-3">
              <label class="input-group-text h-100" for="inputGroupSelect01">Security Questions</label>
              <select class="form-select" id="inputGroupSelect02">
                <option selected>Choose a Security Question</option>
                <option value="q1">In what city were you born?</option>
                <option value="q2">What is the name of your favorite pet?</option>
                <option value="q3">What is your mother's maiden name?</option>
                <option value="q4">What high school did you attend?</option>
                <option value="q5">What was the name of your elementary school?</option>
                <option value="q6">What was the make of your first car?</option>
                <option value="q7">What was your favorite food as a child?</option>
                <option value="q8">Where did you meet your spouse?</option>
                <option value="q9">What year was your father (or mother) born?</option>
              </select>
            </div>
            <div class="col-md-12">
              <label for="securityAnswer" class="form-label">Security Answer</label>
              <input type="text" class="form-control" id="securityAnswer">
            </div>


            <div class="col-12">
              <button type="submit" class="btn btn-dark btn-lg" id="savebasic">Save</button>
            </div>
          </form>
        </div>
      </div>
      <!-- Personal Details -->
      <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
        <div class="pim-form-personal">
          <!-- Names -->
          <form class="row g-3">
            <div class="col-md-4 form-floating">
              <input type="text" class="form-control form-control-sm" placeholder="Leave a comment here" id="floatingTextarea1"></textarea>
              <label for="First Name">First Name</label>
            </div>
            <div class="col-md-4 form-floating">
              <input type="text" class="form-control form-control-sm" placeholder="Leave a comment here" id="floatingTextarea2"></textarea>
              <label for="floatingTextarea">Middle Name</label>
            </div>
            <div class="col-md-4 form-floating">
              <input type="text" class="form-control form-control-sm" placeholder="Leave a comment here" id="floatingTextarea3"></textarea>
              <label for="floatingTextarea">Last Name</label>
            </div>
            <!-- Occupation & DOB -->
            <span class="col-md-6">
              <div class="input-group">
                <label class="input-group-text h-100" for="inputGroupSelect01">Select Occupation</label>
                <select class="form-select form-select-sm" id="inputGroupSelect04">
                  <option selected>Choose...</option>
                  <option value="1">GOVERNMENT</option>
                  <option value="2">PUBLIC</option>
                  <option value="3">PRIVATE</option>
                  <option value="4">PROFESSIONAL</option>
                  <option value="5">SELF EMPLOYED</option>
                  <option value="6">STUDENT</option>
                  <option value="7">OTHER</option>
                </select>
              </div>
            </span>
            <span class="col-md-6">
              <div class="input-group">
                <label class="input-group-text" for="inputGroupSelect01">Date of Birth</label>
                <input type="date" name="DOB" value="DOB" id="DOB">
              </div>
            </span>
            <!-- Marital Status & Country -->
            <div class="col-md-6">
              <div class="form-check form-check-inline col-md-3">
                <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1" value="option1">
                <label class="form-check-label" for="inlineRadio1">Married</label>
              </div>
              <div class="form-check form-check-inline col-md-3">
                <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2" value="option2">
                <label class="form-check-label" for="inlineRadio2">Unmarried</label>
              </div>
            </div>
            <div class="col-md-6 country">
              <div class="input-group mb-3">
                <label class="input-group-text mh-100" for="inputGroupSelect01">Country</label>
                <select class="form-select form-select-sm" id="inputGroupSelect05">
                  <option selected>Choose...</option>
                  <option value="1">INDIA</option>
                  <option value="2">USA</option>
                  <option value="3">GERMANY</option>
                  <option value="4">ENGLAND</option>
                  <option value="5">AUSTRALIA</option>
                  <option value="6">CHINA</option>
                  <option value="7">JAPAN</option>
                  <option value="8">RUSSIA</option>
                  <option value="9">CANADA</option>
                  <option value="10">NEW ZEALAND</option>
                </select>
              </div>
            </div>
            <!-- Gender & phone number -->
            <div class="col-md-6">
              <div class="btn-group btn-group-lg w-100" role="group" aria-label="Basic radio toggle button group">
                <input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off">
                <label class="btn btn-light btn-outline-dark" for="btnradio1">Male</label>

                <input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off">
                <label class="btn btn-light btn-outline-dark" for="btnradio2">Female</label>

                <input type="radio" class="btn-check" name="btnradio" id="btnradio3" autocomplete="off">
                <label class="btn btn-light btn-outline-dark" for="btnradio3">Transgender</label>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-floating mb-3 h-50 w-75">
                <input type="number" class="form-control" id="number" placeholder="xxxxxxxxxx" maxlength="10" min="10">
                <label for="number">Mobile Number</label>
              </div>
            </div>

            <div class="col-12">
              <button type="submit" class="btn btn-dark btn-lg" id="save2">Save</button>
            </div>
          </form>
        </div>
      </div>
      <!-- Address -->
      <div class="tab-pane fade pim-form-address" id="contact" role="tabpanel" aria-labelledby="contact-tab">
        <form class="row g-3">
          <div class="col-md-6">
            <label for="flat" class="form-label">Flat/Door/Block No.</label>
            <input type="text" class="form-control" id="flat">
          </div>
          <div class="col-md-6">
            <label for="street" class="form-label">Street/Lane</label>
            <input type="text" class="form-control" id="street">
          </div>
          <div class="col-md-6">
            <label for="area" class="form-label">Area/Locality</label>
            <input type="text" class="form-control" id="area" >
          </div>
          <div class="col-md-6">
            <label for="pincode" class="form-label">Pincode</label>
            <input type="number" class="form-control" id="pincode">
          </div>
          <div class="col-md-6">
            <label for="state" class="form-label">State</label>
            <input type="text" class="form-control" id="state">
          </div>
          <div class="col-md-6">
            <label for="city" class="form-label">City</label>
            <input type="text" class="form-control" id="city">
          </div>
          <div class="col-12">
            <button type="submit" class="btn btn-dark btn-lg" id="save3">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <script type="module">
     import { getDatabase, ref, child, get,set } from "https://www.gstatic.com/firebasejs/9.13.0/firebase-database.js";
     import {app} from './js/firebase.js'
     import {getAuth,signOut } from "https://www.gstatic.com/firebasejs/9.13.0/firebase-auth.js";
  
    //  const database=getDatabase(app);
    const userId=localStorage.id;
    const auth = getAuth();
    

  const dbRef = ref(getDatabase(app));
  var user={};
  get(child(dbRef, `users/${userId}`)).then((snapshot) => {
    if (snapshot.exists()) {
      console.log(snapshot.val())
      user=snapshot.val();
      document.getElementById('inputEmail4').value=user.email;
    document.getElementById('inputEmail4').disabled=true
    document.getElementById('username4').value=user.username;
    document.getElementById('username4').disabled=true
    document.getElementById('id').innerHTML=`Name: ${user.username}`;
    document.getElementById('inputGroupSelect01').value=user?.basicdetails?.planguage;
    document.getElementById('inputGroupSelect02').value=user?.basicdetails?.squestion;
    document.getElementById('securityAnswer').value=user?.basicdetails?.sanswer;
    document.getElementById('floatingTextarea1').value=user.personaldetails.fname;
    document.getElementById('floatingTextarea2').value=user.personaldetails.mname;
    document.getElementById('floatingTextarea3').value=user.personaldetails.lname;
    document.getElementById('inputGroupSelect04').value=user.personaldetails.occupation;
    document.getElementById('DOB').value=user.personaldetails.DOB;
    document.getElementsByName('inlineRadioOptions').value=user.personaldetails.mstatus;
    document.getElementsByName('btnradio').value=user.personaldetails.gender;
    document.getElementById('number').value=user.personaldetails.number;
    document.getElementById('flat').value=user.addressdetails.flat;
    document.getElementById('street').value=user.addressdetails.street;
    document.getElementById('area').value=user.addressdetails.area;
    document.getElementById('pincode').value=user.addressdetails.pincode;
    document.getElementById('state').value=user.addressdetails.state;
    document.getElementById('city').value=user.addressdetails.city;
    } else {
      console.log("No data available");
    }
  }).catch((error) => {
    console.error(error);
  });
  savebasic.addEventListener('click',(e)=>{
    e.preventDefault()
    var planguage=document.getElementById('inputGroupSelect01').value;
    console.log(planguage)
    var squestion=document.getElementById('inputGroupSelect02').value;
    var sanswer=document.getElementById('securityAnswer').value;
    const db = getDatabase(app);
    set(ref(db, 'users/' + userId+'/basicdetails'), {
      planguage: planguage,
      squestion: squestion,
      sanswer : sanswer
    });
    alert("data added")
  })
  save2.addEventListener('click',(e)=>{
    e.preventDefault()
    var fname=document.getElementById('floatingTextarea1').value;
    var mname=document.getElementById('floatingTextarea2').value;
    var lname=document.getElementById('floatingTextarea3').value;
    var occupation=document.getElementById('inputGroupSelect04').value;
    var DOB=document.getElementById('DOB').value;
    console.log(DOB)
    var ele = document.getElementsByName('inlineRadioOptions');
    var mstatus;
            for(var i = 0; i < ele.length; i++) {
                if(ele[i].checked)
                mstatus=ele[i].value;
            }
    var country=document.getElementById('inputGroupSelect05').value;
   
    var ele1 = document.getElementsByName('btnradio');
    var gender;
            for(var i = 0; i < ele1.length; i++) {
                if(ele1[i].checked)
                gender=ele1[i].value;
            }
    var number=document.getElementById('number').value;
    const db = getDatabase(app);
    set(ref(db, 'users/' + userId+'/personaldetails'), {
      fname:fname,
      mname:mname,
      lname:lname,
      occupation:occupation,
      DOB:DOB,
      mstatus:mstatus,
      country:country,
      gender:gender,
      number:number
    });
    alert("data added")
  })
  save3.addEventListener('click',(e)=>{
    var flat=document.getElementById('flat').value;
    var street=document.getElementById('street').value;
    var area=document.getElementById('area').value;
    var pincode=document.getElementById('pincode').value;
    var state=document.getElementById('state').value;
    var city=document.getElementById('city').value;
    const db = getDatabase(app);
    set(ref(db, 'users/' + userId+'/addressdetails'), {
      flat:flat,
      street:street,
      area:area,
      pincode:pincode,
      state:state,
      city:city,
    });
    alert("data added")
  })
  logout.addEventListener('click',(e)=>{
    signOut(auth).then(() => {
    // Sign-out successful.
    localStorage.clear()
    window.location.replace("http://127.0.0.1:5500/login.html");
  }).catch((error) => {
    // An error happened.
  });
})
  </script>

</body>

</html>
